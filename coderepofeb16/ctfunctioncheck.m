function [ ct ] = ctfunction(rleft,rright,zbot,ztop,mat,dt)
%CTfunction Summary of this function goes here
%   Detailed explanation goes here

j=0.25*(rright-rleft)*(ztop-zbot);
%j=1;
ct=j^2*1/dt*[ (4*(3*rleft + rright))/(9*(rleft - rright)*(zbot - ztop)),   (4*(rleft + rright))/(9*(rleft - rright)*(zbot - ztop)),   (2*(rleft + rright))/(9*(rleft - rright)*(zbot - ztop)), (2*(3*rleft + rright))/(9*(rleft - rright)*(zbot - ztop));
   (4*(rleft + rright))/(9*(rleft - rright)*(zbot - ztop)), (4*(rleft + 3*rright))/(9*(rleft - rright)*(zbot - ztop)), (2*(rleft + 3*rright))/(9*(rleft - rright)*(zbot - ztop)),   (2*(rleft + rright))/(9*(rleft - rright)*(zbot - ztop));
   (2*(rleft + rright))/(9*(rleft - rright)*(zbot - ztop)), (2*(rleft + 3*rright))/(9*(rleft - rright)*(zbot - ztop)), (4*(rleft + 3*rright))/(9*(rleft - rright)*(zbot - ztop)),   (4*(rleft + rright))/(9*(rleft - rright)*(zbot - ztop));
 (2*(3*rleft + rright))/(9*(rleft - rright)*(zbot - ztop)),   (2*(rleft + rright))/(9*(rleft - rright)*(zbot - ztop)),   (4*(rleft + rright))/(9*(rleft - rright)*(zbot - ztop)), (4*(3*rleft + rright))/(9*(rleft - rright)*(zbot - ztop))];


ct=j^2*1/dt*[                              (144115188075855873*(216345702438951151427732876073571*rleft + 72115234146317036146095857063780*rright))/(23384026197294446691258957323460528314494920687616*(rleft - rright)*(zbot - ztop)),                                   (11701365740950795557844690579806234014070292779896881829532862425*(rleft + rright))/(26328072917139296674479506920917608079723773850137277813577744384*(rleft - rright)*(zbot - ztop)),      (3293641649416992471618766235566099675645771231431237735918105931360846647114375*(rleft + rright))/(14821387422376473014217086081112052205218558037201992197050570753012880593911808*(rleft - rright)*(zbot - ztop)), (40564819207303332542491067726175*(216345702438951151427732876073571*rleft + 72115234146317036146095857063780*rright))/(13164036458569648337239753460458804039861886925068638906788872192*(rleft - rright)*(zbot - ztop));
                                   (11701365740950795557844690579806234014070292779896881829532862425*(rleft + rright))/(26328072917139296674479506920917608079723773850137277813577744384*(rleft - rright)*(zbot - ztop)),                              (144115188075855873*(72115234146317036146095857063780*rleft + 216345702438951151427732876073571*rright))/(23384026197294446691258957323460528314494920687616*(rleft - rright)*(zbot - ztop)), (40564819207303332542491067726175*(72115234146317036146095857063780*rleft + 216345702438951151427732876073571*rright))/(13164036458569648337239753460458804039861886925068638906788872192*(rleft - rright)*(zbot - ztop)),      (3293641649416992471618766235566099675645771231431237735918105931360846647114375*(rleft + rright))/(14821387422376473014217086081112052205218558037201992197050570753012880593911808*(rleft - rright)*(zbot - ztop));
     (3293641649416992471618766235566099675645771231431237735918105931360846647114375*(rleft + rright))/(14821387422376473014217086081112052205218558037201992197050570753012880593911808*(rleft - rright)*(zbot - ztop)), (40564819207303332542491067726175*(72115234146317036146095857063780*rleft + 216345702438951151427732876073571*rright))/(13164036458569648337239753460458804039861886925068638906788872192*(rleft - rright)*(zbot - ztop)),                              (144115188075855873*(72115234146317036146095857063780*rleft + 216345702438951151427732876073571*rright))/(23384026197294446691258957323460528314494920687616*(rleft - rright)*(zbot - ztop)),                                   (11701365740950795557844690579806234014070292779896881829532862425*(rleft + rright))/(26328072917139296674479506920917608079723773850137277813577744384*(rleft - rright)*(zbot - ztop));
 (40564819207303332542491067726175*(216345702438951151427732876073571*rleft + 72115234146317036146095857063780*rright))/(13164036458569648337239753460458804039861886925068638906788872192*(rleft - rright)*(zbot - ztop)),      (3293641649416992471618766235566099675645771231431237735918105931360846647114375*(rleft + rright))/(14821387422376473014217086081112052205218558037201992197050570753012880593911808*(rleft - rright)*(zbot - ztop)),                                   (11701365740950795557844690579806234014070292779896881829532862425*(rleft + rright))/(26328072917139296674479506920917608079723773850137277813577744384*(rleft - rright)*(zbot - ztop)),                              (144115188075855873*(216345702438951151427732876073571*rleft + 72115234146317036146095857063780*rright))/(23384026197294446691258957323460528314494920687616*(rleft - rright)*(zbot - ztop))];
 
    

%if mat==1
   ct=sum(sum(ct))/sum(diag(ct))*[ct(1,1) 0 0 0; 0 ct(2,2) 0 0; 0 0 ct(3,3) 0; 0 0 0 ct(4,4)]; 
%end
end

